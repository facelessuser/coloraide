<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A library to aid in using colors"><link href=https://facelessuser.github.io/coloraide/gamut/ rel=canonical><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.5.0"><title>Gamut Mapping - ColorAide Documentation</title><link rel=stylesheet href=../assets/stylesheets/main.2e8b5541.min.css><link rel=stylesheet href=../assets/stylesheets/palette.cbb835fc.min.css><meta name=theme-color content=#7e56c2><script src=../assets/pymdownx-extras/material-extra-theme-7c147bb7.js type=text/javascript></script><script src=../assets/pymdownx-extras/material-extra-3rdparty-f4ebda09.js type=text/javascript></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../assets/coloraide-extras/extra-753860a807.css><link rel=stylesheet href=../assets/pymdownx-extras/extra-2d846d3021.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=dracula data-md-color-primary=deep-purple data-md-color-accent=deep-purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#gamut-mapping class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <span class=twemoji> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m23 12-2.44-2.78.34-3.68-3.61-.82-1.89-3.18L12 3 8.6 1.54 6.71 4.72l-3.61.81.34 3.68L1 12l2.44 2.78-.34 3.69 3.61.82 1.89 3.18L12 21l3.4 1.46 1.89-3.18 3.61-.82-.34-3.68L23 12m-10 5h-2v-2h2v2m0-4h-2V7h2v6Z"/></svg> </span> Stable 1.4 has been released! Check out the <a href=../about/releases/1.0> release notes</a> for more information and migration tips. <br> <a href=../about/contributing/#become-a-sponsor>Sponsorship</a> is now available! <span class="twemoji heart-throb"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path fill-rule=evenodd d="M7.655 14.916 8 14.25l.345.666a.752.752 0 0 1-.69 0zm0 0L8 14.25l.345.666.002-.001.006-.003.018-.01a7.643 7.643 0 0 0 .31-.17 22.08 22.08 0 0 0 3.433-2.414C13.956 10.731 16 8.35 16 5.5 16 2.836 13.914 1 11.75 1 10.203 1 8.847 1.802 8 3.02 7.153 1.802 5.797 1 4.25 1 2.086 1 0 2.836 0 5.5c0 2.85 2.045 5.231 3.885 6.818a22.075 22.075 0 0 0 3.744 2.584l.018.01.006.003h.002z"/></svg> </span> </div> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=https://facelessuser.github.io/coloraide/ title="ColorAide Documentation" class="md-header__button md-logo" aria-label="ColorAide Documentation"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5V2M6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> ColorAide Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Gamut Mapping </span> </div> </div> </div> <div class=md-header__options> <div class="md-header-nav__scheme md-header-nav__button md-source__icon md-icon"> <a href=javascript:toggleScheme(); title="Light mode" class=light-mode> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg> </a> <a href=javascript:toggleScheme(); title="Dark mode" class=dark-mode> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg> </a> <a href=javascript:toggleScheme(); title="System preference" class=system-mode> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7.5 2c-1.79 1.15-3 3.18-3 5.5s1.21 4.35 3.03 5.5C4.46 13 2 10.54 2 7.5A5.5 5.5 0 0 1 7.5 2m11.57 1.5 1.43 1.43L4.93 20.5 3.5 19.07 19.07 3.5m-6.18 2.43L11.41 5 9.97 6l.42-1.7L9 3.24l1.75-.12.58-1.65L12 3.1l1.73.03-1.35 1.13.51 1.67m-3.3 3.61-1.16-.73-1.12.78.34-1.32-1.09-.83 1.36-.09.45-1.29.51 1.27 1.36.03-1.05.87.4 1.31M19 13.5a5.5 5.5 0 0 1-5.5 5.5c-1.22 0-2.35-.4-3.26-1.07l7.69-7.69c.67.91 1.07 2.04 1.07 3.26m-4.4 6.58 2.77-1.15-.24 3.35-2.53-2.2m4.33-2.7 1.15-2.77 2.2 2.54-3.35.23m1.15-4.96-1.14-2.78 3.34.24-2.2 2.54M9.63 18.93l2.77 1.15-2.53 2.19-.24-3.34Z"/></svg> </a> <a href=javascript:toggleScheme(); title="Unknown scheme" class=unknown-mode> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m15.07 11.25-.9.92C13.45 12.89 13 13.5 13 15h-2v-.5c0-1.11.45-2.11 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41a2 2 0 0 0-2-2 2 2 0 0 0-2 2H8a4 4 0 0 1 4-4 4 4 0 0 1 4 4 3.2 3.2 0 0 1-.93 2.25M13 19h-2v-2h2M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10c0-5.53-4.5-10-10-10Z"/></svg> </a> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/facelessuser/coloraide title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class="md-tabs__link md-tabs__link--active"> ColorAide </a> </li> <li class=md-tabs__item> <a href=../colors/ class=md-tabs__link> Color Spaces </a> </li> <li class=md-tabs__item> <a href=../plugins/ class=md-tabs__link> Plugins </a> </li> <li class=md-tabs__item> <a href=../api/ class=md-tabs__link> API </a> </li> <li class=md-tabs__item> <a href=../playground/ class=md-tabs__link> Playground </a> </li> <li class=md-tabs__item> <a href=../about/contributing/ class=md-tabs__link> About </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="ColorAide Documentation" class="md-nav__button md-logo" aria-label="ColorAide Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5V2M6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5Z"/></svg> </a> ColorAide Documentation </label> <div class=md-nav__source> <a href=https://github.com/facelessuser/coloraide title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1 checked> <div class="md-nav__link md-nav__link--index "> <a href=..>ColorAide</a> <label for=__nav_1> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=ColorAide data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> ColorAide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../color/ class=md-nav__link> The Color Object </a> </li> <li class=md-nav__item> <a href=../manipulation/ class=md-nav__link> Manipulating Colors </a> </li> <li class=md-nav__item> <a href=../interpolation/ class=md-nav__link> Color Interpolation </a> </li> <li class=md-nav__item> <a href=../compositing/ class=md-nav__link> Compositing and Blending </a> </li> <li class=md-nav__item> <a href=../distance/ class=md-nav__link> Color Distance and Delta E </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Gamut Mapping <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Gamut Mapping </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#checking-gamut class=md-nav__link> Checking Gamut </a> <nav class=md-nav aria-label="Checking Gamut"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tolerance class=md-nav__link> Tolerance </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#mapping-colors class=md-nav__link> Mapping Colors </a> <nav class=md-nav aria-label="Mapping Colors"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#why-not-just-clip class=md-nav__link> Why Not Just Clip? </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../cat/ class=md-nav__link> Chromatic Adaptation </a> </li> <li class=md-nav__item> <a href=../contrast/ class=md-nav__link> Contrast </a> </li> <li class=md-nav__item> <a href=../harmonies/ class=md-nav__link> Color Harmonies </a> </li> <li class=md-nav__item> <a href=../filters/ class=md-nav__link> Filters </a> </li> <li class=md-nav__item> <a href=../strings/ class=md-nav__link> String Output </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <div class="md-nav__link md-nav__link--index "> <a href=../colors/ >Color Spaces</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Color Spaces" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Color Spaces </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> RGB Color Spaces <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="RGB Color Spaces" data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> RGB Color Spaces </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../colors/srgb/ class=md-nav__link> sRGB </a> </li> <li class=md-nav__item> <a href=../colors/display_p3/ class=md-nav__link> Display P3 </a> </li> <li class=md-nav__item> <a href=../colors/a98_rgb/ class=md-nav__link> A98 RGB </a> </li> <li class=md-nav__item> <a href=../colors/rec2020/ class=md-nav__link> Rec. 2020 </a> </li> <li class=md-nav__item> <a href=../colors/prophoto_rgb/ class=md-nav__link> ProPhoto RGB </a> </li> <li class=md-nav__item> <a href=../colors/rec2100pq/ class=md-nav__link> Rec. 2100 PQ </a> </li> <li class=md-nav__item> <a href=../colors/srgb_linear/ class=md-nav__link> Linear sRGB </a> </li> <li class=md-nav__item> <a href=../colors/display_p3_linear/ class=md-nav__link> Linear Display P3 </a> </li> <li class=md-nav__item> <a href=../colors/a98_rgb_linear/ class=md-nav__link> Linear A98 RGB </a> </li> <li class=md-nav__item> <a href=../colors/rec2020_linear/ class=md-nav__link> Linear Rec. 2020 </a> </li> <li class=md-nav__item> <a href=../colors/prophoto_rgb_linear/ class=md-nav__link> Linear ProPhoto RGB </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3> Cylindrical sRGB Spaces <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cylindrical sRGB Spaces" data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Cylindrical sRGB Spaces </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../colors/hsv/ class=md-nav__link> HSV </a> </li> <li class=md-nav__item> <a href=../colors/hsl/ class=md-nav__link> HSL </a> </li> <li class=md-nav__item> <a href=../colors/hwb/ class=md-nav__link> HWB </a> </li> <li class=md-nav__item> <a href=../colors/hsi/ class=md-nav__link> HSI </a> </li> <li class=md-nav__item> <a href=../colors/okhsv/ class=md-nav__link> Okhsv </a> </li> <li class=md-nav__item> <a href=../colors/okhsl/ class=md-nav__link> Okhsl </a> </li> <li class=md-nav__item> <a href=../colors/hsluv/ class=md-nav__link> HSLuv </a> </li> <li class=md-nav__item> <a href=../colors/hpluv/ class=md-nav__link> HPLuv </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> XYZ Spaces <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="XYZ Spaces" data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> XYZ Spaces </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../colors/xyz_d65/ class=md-nav__link> XYZ D65 </a> </li> <li class=md-nav__item> <a href=../colors/xyz_d50/ class=md-nav__link> XYZ D50 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_5 type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5> Lab Like Spaces <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Lab Like Spaces" data-md-level=2> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Lab Like Spaces </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../colors/lab/ class=md-nav__link> Lab D50 </a> </li> <li class=md-nav__item> <a href=../colors/lab_d65/ class=md-nav__link> Lab D65 </a> </li> <li class=md-nav__item> <a href=../colors/oklab/ class=md-nav__link> Oklab </a> </li> <li class=md-nav__item> <a href=../colors/luv/ class=md-nav__link> Luv </a> </li> <li class=md-nav__item> <a href=../colors/din99o/ class=md-nav__link> DIN99o </a> </li> <li class=md-nav__item> <a href=../colors/jzazbz/ class=md-nav__link> Jzazbz </a> </li> <li class=md-nav__item> <a href=../colors/hunter_lab/ class=md-nav__link> Hunter Lab </a> </li> <li class=md-nav__item> <a href=../colors/rlab/ class=md-nav__link> RLAB </a> </li> <li class=md-nav__item> <a href=../colors/ipt/ class=md-nav__link> IPT </a> </li> <li class=md-nav__item> <a href=../colors/ictcp/ class=md-nav__link> ICtCp </a> </li> <li class=md-nav__item> <a href=../colors/igpgtg/ class=md-nav__link> IgPgTg </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_6 type=checkbox id=__nav_2_6> <label class=md-nav__link for=__nav_2_6> LCh Like Spaces <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="LCh Like Spaces" data-md-level=2> <label class=md-nav__title for=__nav_2_6> <span class="md-nav__icon md-icon"></span> LCh Like Spaces </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../colors/lch/ class=md-nav__link> LCh D50 </a> </li> <li class=md-nav__item> <a href=../colors/lch_d65/ class=md-nav__link> LCh D65 </a> </li> <li class=md-nav__item> <a href=../colors/oklch/ class=md-nav__link> OkLCh </a> </li> <li class=md-nav__item> <a href=../colors/lchuv/ class=md-nav__link> LCh(uv) </a> </li> <li class=md-nav__item> <a href=../colors/lch99o/ class=md-nav__link> DIN99 LCh </a> </li> <li class=md-nav__item> <a href=../colors/jzczhz/ class=md-nav__link> JzCzhz </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_7 type=checkbox id=__nav_2_7> <label class=md-nav__link for=__nav_2_7> ACES Spaces <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="ACES Spaces" data-md-level=2> <label class=md-nav__title for=__nav_2_7> <span class="md-nav__icon md-icon"></span> ACES Spaces </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../colors/aces2065_1/ class=md-nav__link> ACES 2065-1 </a> </li> <li class=md-nav__item> <a href=../colors/acescg/ class=md-nav__link> ACEScg </a> </li> <li class=md-nav__item> <a href=../colors/acescc/ class=md-nav__link> ACEScc </a> </li> <li class=md-nav__item> <a href=../colors/acescct/ class=md-nav__link> ACEScct </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_8 type=checkbox id=__nav_2_8> <label class=md-nav__link for=__nav_2_8> Miscellaneous Spaces <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Miscellaneous Spaces" data-md-level=2> <label class=md-nav__title for=__nav_2_8> <span class="md-nav__icon md-icon"></span> Miscellaneous Spaces </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../colors/xyy/ class=md-nav__link> xyY </a> </li> <li class=md-nav__item> <a href=../colors/cmy/ class=md-nav__link> CMY </a> </li> <li class=md-nav__item> <a href=../colors/cmyk/ class=md-nav__link> CMYK </a> </li> <li class=md-nav__item> <a href=../colors/orgb/ class=md-nav__link> oRGB </a> </li> <li class=md-nav__item> <a href=../colors/prismatic/ class=md-nav__link> Prismatic </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <div class="md-nav__link md-nav__link--index "> <a href=../plugins/ >Plugins</a> <label for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Plugins data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Plugins </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../plugins/delta_e/ class=md-nav__link> Delta E </a> </li> <li class=md-nav__item> <a href=../plugins/fit/ class=md-nav__link> Fit/Gamut Mapping </a> </li> <li class=md-nav__item> <a href=../plugins/cat/ class=md-nav__link> Chromatic Adaptation </a> </li> <li class=md-nav__item> <a href=../plugins/filter/ class=md-nav__link> Filters </a> </li> <li class=md-nav__item> <a href=../plugins/contrast/ class=md-nav__link> Contrast </a> </li> <li class=md-nav__item> <a href=../plugins/space/ class=md-nav__link> Color Spaces </a> </li> <li class=md-nav__item> <a href=../plugins/interpolate/ class=md-nav__link> Interpolation </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <div class="md-nav__link md-nav__link--index "> <a href=../api/ >API</a> </div> <nav class=md-nav aria-label=API data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> API </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../playground/ class=md-nav__link> Playground </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6> About <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=About data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../about/contributing/ class=md-nav__link> Contributing &amp; Support </a> </li> <li class=md-nav__item> <a href=../about/acknowledgments/ class=md-nav__link> Acknowledgments </a> </li> <li class=md-nav__item> <a href=../about/changelog/ class=md-nav__link> Changelog </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6_4 type=checkbox id=__nav_6_4> <label class=md-nav__link for=__nav_6_4> Migration Notes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Migration Notes" data-md-level=2> <label class=md-nav__title for=__nav_6_4> <span class="md-nav__icon md-icon"></span> Migration Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../about/releases/1.0/ class=md-nav__link> 1.0 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../about/license/ class=md-nav__link> License </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#checking-gamut class=md-nav__link> Checking Gamut </a> <nav class=md-nav aria-label="Checking Gamut"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tolerance class=md-nav__link> Tolerance </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#mapping-colors class=md-nav__link> Mapping Colors </a> <nav class=md-nav aria-label="Mapping Colors"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#why-not-just-clip class=md-nav__link> Why Not Just Clip? </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=gamut-mapping>Gamut Mapping<a class=headerlink href=#gamut-mapping title="Permanent link"></a></h1> <p>Many color spaces are designed in such a way that they can only represent colors accurately within a specific range. This range in which a color can accurately be represented is known as the color gamut. While some color spaces are theoretically unbounded, there are many that are designed with distinct ranges.</p> <p>The sRGB and Display P3 color spaces are both RGB color spaces, but they actually can represent a different amount of colors. Display P3 has a wider gamut and allows for greener greens and redder reds, etc. In the image below, we show four different RGB color spaces, each with varying different gamut sizes. Display P3 contains all the colors in sRGB and extends it even further. Rec. 2020, another RGB color space, is even wider. ProPhoto is so wide that it contains colors that the human eye can't even see.</p> <p><img alt="Gamut Comparison" src=../images/gamut-compare.png></p> <p>In order to visually represent a color from a wider gamut color space, such as Display P3, in a more narrow color space, such as sRGB, a suitable color within the more narrow color space must must be selected and be shown in its place. This selecting of a suitable replacement is called gamut mapping.</p> <p>ColorAide defines a couple methods to help identify when a color is outside the gamut bounds of a color space and to help find a suitable, alternative color that is within the gamut.</p> <h2 id=checking-gamut>Checking Gamut<a class=headerlink href=#checking-gamut title="Permanent link"></a></h2> <p>When dealing with colors, it can be important to know whether a color is within its own gamut. The <code>in_gamut</code> function allows for comparing the current color's specified values against the color space's gamut.</p> <p>Let's assume we have a color <span><span class="swatch out-of-gamut" title="rgb(30% 105% 0%)"><span class=swatch-color style="--swatch-stops: #6dff3d,#6dff3d;"></span></span><code class=highlight><span class=nf>rgb</span><span class=g>(</span><span class=m>30</span><span class=k>%</span><span class=w> </span><span class=m>105</span><span class=k>%</span><span class=w> </span><span class=m>0</span><span class=k>%</span><span class=g>)</span><span class=w></span></code></span>. The color is out of gamut due to the green channel exceeding the channel's limit of <code class=highlight><span class=mi>100</span><span class=o>%</span></code>. When we execute <code>in_gamut</code>, we can see that the color is not in its own gamut.</p> <div class=playground id=__playground_0> <div class=playground-results id=__playground-results_0> <div class=color-command><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s2>&quot;rgb(30</span><span class=si>% 105%</span><span class=s2> 0%)&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>in_gamut</span><span class=p>()</span>
<span class=go>False</span>
</code></pre></div></div> </div> <div class="playground-code hidden" id=__playground-code_0> <form autocomplete=off> <textarea class=playground-inputs id=__playground-inputs_0 spellcheck=false>Color("rgb(30% 105% 0%)").in_gamut()</textarea> </form> </div> <button id=__playground-edit_0 class=playground-edit title="Edit the current snippet">Edit</button> <button id=__playground-share_0 class=playground-share title="Copy URL to current snippet">Share</button> <button id=__playground-run_0 class="playground-run hidden" title="Run code (Ctrl + Enter)">Run</button> <button id=__playground-cancel_0 class="playground-cancel hidden" title="Cancel edit (Escape)">Cancel</button> </div> <p>On the other hand, some color spaces do not have a limit. CIELab is one such color space. Sometimes limits will be placed on the color space channels for practicality, but theoretically, there are no bounds. When we check a CIELab color, we will find that it is always considered in gamut.</p> <div class=playground id=__playground_1> <div class=playground-results id=__playground-results_1> <div class=color-command><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s2>&quot;lab(200% -20 40 / 1)&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>in_gamut</span><span class=p>()</span>
<span class=go>True</span>
</code></pre></div></div> </div> <div class="playground-code hidden" id=__playground-code_1> <form autocomplete=off> <textarea class=playground-inputs id=__playground-inputs_1 spellcheck=false>Color("lab(200% -20 40 / 1)").in_gamut()</textarea> </form> </div> <button id=__playground-edit_1 class=playground-edit title="Edit the current snippet">Edit</button> <button id=__playground-share_1 class=playground-share title="Copy URL to current snippet">Share</button> <button id=__playground-run_1 class="playground-run hidden" title="Run code (Ctrl + Enter)">Run</button> <button id=__playground-cancel_1 class="playground-cancel hidden" title="Cancel edit (Escape)">Cancel</button> </div> <p>While checking CIELab's own gamut isn't very useful, we can test it against a different color space's gamut. By simply passing in the name of a different color space, the current color will be converted to the provided space and then will run <code>in_gamut</code> on the new color. You could do this manually, but using <code>in_gamut</code> in this manner can be very convenient. In the example below, we can see that the CIELab color of <span><span class="swatch out-of-gamut" title="lab(200% -20 40 / 1)"><span class=swatch-color style="--swatch-stops: #ffffff,#ffffff;"></span></span><code class=highlight><span class=nf>lab</span><span class=g>(</span><span class=m>200</span><span class=k>%</span><span class=w> </span><span class=g>-</span><span class=m>20</span><span class=w> </span><span class=m>40</span><span class=w> </span><span class=g>/</span><span class=w> </span><span class=m>1</span><span class=g>)</span><span class=w></span></code></span> is outside the narrow gamut of sRGB.</p> <div class=playground id=__playground_2> <div class=playground-results id=__playground-results_2> <div class=color-command><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s2>&quot;lab(200% -20 40 / 1)&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>in_gamut</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>)</span>
<span class=go>False</span>
</code></pre></div></div> </div> <div class="playground-code hidden" id=__playground-code_2> <form autocomplete=off> <textarea class=playground-inputs id=__playground-inputs_2 spellcheck=false>Color("lab(200% -20 40 / 1)").in_gamut('srgb')</textarea> </form> </div> <button id=__playground-edit_2 class=playground-edit title="Edit the current snippet">Edit</button> <button id=__playground-share_2 class=playground-share title="Copy URL to current snippet">Share</button> <button id=__playground-run_2 class="playground-run hidden" title="Run code (Ctrl + Enter)">Run</button> <button id=__playground-cancel_2 class="playground-cancel hidden" title="Cancel edit (Escape)">Cancel</button> </div> <h3 id=tolerance>Tolerance<a class=headerlink href=#tolerance title="Permanent link"></a></h3> <p>Generally, ColorAide does not round off values in order to guarantee the best possible values for round tripping, but due to <a href=https://docs.python.org/3/tutorial/floatingpoint.html#floating-point-arithmetic-issues-and-limitations>limitations of floating-point arithmetic</a> and precision of conversion algorithms, there can be edge cases where colors don't round trip perfectly. By default, <code>in_gamut</code> allows for a tolerance of <code class=highlight><span class=mf>0.000075</span></code> to account for such cases where a color is "close enough". If desired, this "tolerance" can be adjusted.</p> <p>Let's consider CIELab with a D65 white point. The sRGB round trip through CIELab D65 for <span><span class=swatch title=white><span class=swatch-color style="--swatch-stops: #ffffff,#ffffff;"></span></span><code class=highlight><span class=kc>white</span><span class=w></span></code></span> does not perfectly convert back to the original color. This is due to the perils of floating point arithmetic.</p> <div class=playground id=__playground_3> <div class=playground-results id=__playground-results_3> <div class=color-command><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s1>&#39;color(srgb 1 1 1)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;lab-d65&#39;</span><span class=p>)[:]</span>
<span class=go>[100.0, 0.0, 0.0, 1.0]</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s1>&#39;color(srgb 1 1 1)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;lab-d65&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>)[:]</span>
<span class=go>[1.0000000000000002, 0.9999999999999999, 0.9999999999999997, 1.0]</span>
</code></pre></div></div> </div> <div class="playground-code hidden" id=__playground-code_3> <form autocomplete=off> <textarea class=playground-inputs id=__playground-inputs_3 spellcheck=false>Color('color(srgb 1 1 1)').convert('lab-d65')[:]
Color('color(srgb 1 1 1)').convert('lab-d65').convert('srgb')[:]</textarea> </form> </div> <button id=__playground-edit_3 class=playground-edit title="Edit the current snippet">Edit</button> <button id=__playground-share_3 class=playground-share title="Copy URL to current snippet">Share</button> <button id=__playground-run_3 class="playground-run hidden" title="Run code (Ctrl + Enter)">Run</button> <button id=__playground-cancel_3 class="playground-cancel hidden" title="Cancel edit (Escape)">Cancel</button> </div> <p>We can see that when using a tolerance of zero, and gamut checking in sRGB, that the color is considered out of gamut. This makes sense as the round trip through CIELab D65 and back is so very close, but ever so slightly off. Depending on what you are doing, this may not be an issue up until you are ready to finalize the color, so sometimes it may be desirable to have some tolerance, and other times not.</p> <div class=playground id=__playground_4> <div class=playground-results id=__playground-results_4> <div class=color-command><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s1>&#39;color(srgb 1 1 1)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;lab-d65&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>)[:]</span>
<span class=go>[1.0000000000000002, 0.9999999999999999, 0.9999999999999997, 1.0]</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s1>&#39;color(srgb 1 1 1)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;lab-d65&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>in_gamut</span><span class=p>()</span>
<span class=go>True</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s1>&#39;color(srgb 1 1 1)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;lab-d65&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>in_gamut</span><span class=p>(</span><span class=n>tolerance</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=go>False</span>
</code></pre></div></div> </div> <div class="playground-code hidden" id=__playground-code_4> <form autocomplete=off> <textarea class=playground-inputs id=__playground-inputs_4 spellcheck=false>Color('color(srgb 1 1 1)').convert('lab-d65').convert('srgb')[:]
Color('color(srgb 1 1 1)').convert('lab-d65').convert('srgb').in_gamut()
Color('color(srgb 1 1 1)').convert('lab-d65').convert('srgb').in_gamut(tolerance=0)</textarea> </form> </div> <button id=__playground-edit_4 class=playground-edit title="Edit the current snippet">Edit</button> <button id=__playground-share_4 class=playground-share title="Copy URL to current snippet">Share</button> <button id=__playground-run_4 class="playground-run hidden" title="Run code (Ctrl + Enter)">Run</button> <button id=__playground-cancel_4 class="playground-cancel hidden" title="Cancel edit (Escape)">Cancel</button> </div> <p>On the topic of tolerance, lets consider some color models that do not handle out of gamut colors very well. There are some color models that are alternate representations of an existing color space. For instance, the cylindrical spaces HSL, HSV, and HWB are just different color models for the sRGB color space. They are are essentially the sRGB color space, just with cylindrical coordinates that isolate certain attributes of the color space: saturation, whiteness, blackness, etc. So their gamut is exactly the same as the sRGB space, because they are the sRGB color space. So it stands to reason that simply using the sRGB gamut check for them should be sufficient, and if we are using strict tolerance, this would be true.</p> <div class=playground id=__playground_5> <div class=playground-results id=__playground-results_5> <div class=color-command><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s1>&#39;rgb(255 255 255)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>in_gamut</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>,</span> <span class=n>tolerance</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=go>True</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s1>&#39;hsl(0 0</span><span class=si>% 100%</span><span class=s1>)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>in_gamut</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>,</span> <span class=n>tolerance</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=go>True</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s1>&#39;color(--hsv 0 0</span><span class=si>% 100%</span><span class=s1>)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>in_gamut</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>,</span> <span class=n>tolerance</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=go>True</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s1>&#39;rgb(255.05 255 255)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>in_gamut</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>,</span> <span class=n>tolerance</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=go>False</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s1>&#39;hsl(0 0</span><span class=si>% 100.05%</span><span class=s1>)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>in_gamut</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>,</span> <span class=n>tolerance</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=go>False</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s1>&#39;color(--hsv 0 0</span><span class=si>% 100.05%</span><span class=s1>)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>in_gamut</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>,</span> <span class=n>tolerance</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=go>False</span>
</code></pre></div></div> </div> <div class="playground-code hidden" id=__playground-code_5> <form autocomplete=off> <textarea class=playground-inputs id=__playground-inputs_5 spellcheck=false>Color('rgb(255 255 255)').in_gamut('srgb', tolerance=0)
Color('hsl(0 0% 100%)').in_gamut('srgb', tolerance=0)
Color('color(--hsv 0 0% 100%)').in_gamut('srgb', tolerance=0)
Color('rgb(255.05 255 255)').in_gamut('srgb', tolerance=0)
Color('hsl(0 0% 100.05%)').in_gamut('srgb', tolerance=0)
Color('color(--hsv 0 0% 100.05%)').in_gamut('srgb', tolerance=0)</textarea> </form> </div> <button id=__playground-edit_5 class=playground-edit title="Edit the current snippet">Edit</button> <button id=__playground-share_5 class=playground-share title="Copy URL to current snippet">Share</button> <button id=__playground-run_5 class="playground-run hidden" title="Run code (Ctrl + Enter)">Run</button> <button id=__playground-cancel_5 class="playground-cancel hidden" title="Cancel edit (Escape)">Cancel</button> </div> <p>But when we are not using a strict threshold, and we check one of these models <strong>only</strong> using the sRGB gamut, there are some cases where these cylindrical colors can exhibit coordinates wildly outside of the model's range but still very close to the sRGB gamut.</p> <p>In this example, we have an sRGB color that is extremely close to being in gamut, but when we convert it to HSL, we can see wildly large saturation.</p> <div class=playground id=__playground_6> <div class=playground-results id=__playground-results_6> <div class=color-command><div class=swatch-bar><span class=swatch title="hsl(142.5 200.06% 100%)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(255 255 255) 50%, rgb(255 255 255) 50%"></span></span></div><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>hsl</span> <span class=o>=</span> <span class=n>Color</span><span class=p>(</span><span class=s1>&#39;color(srgb 0.9999999999994 1.0000000000002 0.9999999999997)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;hsl&#39;</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>hsl</span><span class=o>.</span><span class=n>to_string</span><span class=p>(</span><span class=n>fit</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=go>hsl(142.5 200.06% 100%)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>hsl</span><span class=o>.</span><span class=n>in_gamut</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>)</span>
<span class=go>True</span>
</code></pre></div></div> </div> <div class="playground-code hidden" id=__playground-code_6> <form autocomplete=off> <textarea class=playground-inputs id=__playground-inputs_6 spellcheck=false>hsl = Color('color(srgb 0.9999999999994 1.0000000000002 0.9999999999997)').convert('hsl')
hsl.to_string(fit=False)
hsl.in_gamut('srgb')</textarea> </form> </div> <button id=__playground-edit_6 class=playground-edit title="Edit the current snippet">Edit</button> <button id=__playground-share_6 class=playground-share title="Copy URL to current snippet">Share</button> <button id=__playground-run_6 class="playground-run hidden" title="Run code (Ctrl + Enter)">Run</button> <button id=__playground-cancel_6 class="playground-cancel hidden" title="Cancel edit (Escape)">Cancel</button> </div> <p>This happens because these cylindrical color models do not represent colors out of gamut in a very sane way. They are simply not designed to extend past the color gamut. So even a slightly out of gamut sRGB color can translate to a value way outside the cylindrical color model's boundaries.</p> <p>For this reason, gamut checks in the HSL, HSV, or HWB models apply tolerance checks on the color's coordinates in the sRGB color space <strong>and</strong> the respective cylindrical model ensuring we have coordinates that are close to the color's actual gamut and reasonably close to the cylindrical model's constraints as well.</p> <p>So, when using HSL as the gamut check, we can see that it ensures the color is not only very close to the sRGB gamut, but that it is also very close the color model's constraints.</p> <div class=playground id=__playground_7> <div class=playground-results id=__playground-results_7> <div class=color-command><div class=swatch-bar><span class=swatch title="hsl(142.5 200.06% 100%)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(255 255 255) 50%, rgb(255 255 255) 50%"></span></span></div><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>hsl</span> <span class=o>=</span> <span class=n>Color</span><span class=p>(</span><span class=s1>&#39;color(srgb 0.9999999999994 1.0000000000002 0.9999999999997)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;hsl&#39;</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>hsl</span>
<span class=go>color(--hsl 142.5 2.0006 1 / 1)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>hsl</span><span class=o>.</span><span class=n>in_gamut</span><span class=p>(</span><span class=s1>&#39;hsl&#39;</span><span class=p>)</span>
<span class=go>False</span>
</code></pre></div></div> </div> <div class="playground-code hidden" id=__playground-code_7> <form autocomplete=off> <textarea class=playground-inputs id=__playground-inputs_7 spellcheck=false>hsl = Color('color(srgb 0.9999999999994 1.0000000000002 0.9999999999997)').convert('hsl')
hsl
hsl.in_gamut('hsl')</textarea> </form> </div> <button id=__playground-edit_7 class=playground-edit title="Edit the current snippet">Edit</button> <button id=__playground-share_7 class=playground-share title="Copy URL to current snippet">Share</button> <button id=__playground-run_7 class="playground-run hidden" title="Run code (Ctrl + Enter)">Run</button> <button id=__playground-cancel_7 class="playground-cancel hidden" title="Cancel edit (Escape)">Cancel</button> </div> <p>If the Cartesian check is the only desired check, and the strange cylindrical values that are returned are not a problem, <code>srgb</code> can always be specified. <code class=highlight><span class=n>tolerance</span><span class=o>=</span><span class=mi>0</span></code> can also be used to constrain the check to values exactly in the gamut.</p> <p>When a color is precisely in gamut, HSL has a very tight conversion to and from sRGB. A color that is in gamut, will remain in gamut throughout the conversion, forwards and backwards. On the other hand, there may be color models that have a looser conversion algorithm. There may be cases where it may be beneficial to decrease the threshold.</p> <h2 id=mapping-colors>Mapping Colors<a class=headerlink href=#mapping-colors title="Permanent link"></a></h2> <p>Gamut mapping is the process of taking a color that is out of gamut and adjusting it such that it fits within the gamut.</p> <p>Gamut mapping in general is performed via the <code class=highlight><span class=n>fit</span><span class=p>()</span></code> method. Doing this will cause the default gamut mapping to be used. If desired, a user can also specify any currently registered gamut mapping method via the <code>method</code> parameter.</p> <div class=playground id=__playground_8> <div class=playground-results id=__playground-results_8> <div class=color-command><div class=swatch-bar><span class=swatch title="rgb(255 47.189 120.96)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(255 47.189 120.96) 50%, rgb(255 47.189 120.96) 50%"></span></span> <span class=swatch title="rgb(255 30 120)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(255 30 120) 50%, rgb(255 30 120) 50%"></span></span></div><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s1>&#39;rgb(270 30 120)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>fit</span><span class=p>()</span>
<span class=go>color(srgb 1 0.18505 0.47435 / 1)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s1>&#39;rgb(270 30 120)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=s1>&#39;clip&#39;</span><span class=p>)</span>
<span class=go>color(srgb 1 0.11765 0.47059 / 1)</span>
</code></pre></div></div> </div> <div class="playground-code hidden" id=__playground-code_8> <form autocomplete=off> <textarea class=playground-inputs id=__playground-inputs_8 spellcheck=false>Color('rgb(270 30 120)').fit()
Color('rgb(270 30 120)').fit(method='clip')</textarea> </form> </div> <button id=__playground-edit_8 class=playground-edit title="Edit the current snippet">Edit</button> <button id=__playground-share_8 class=playground-share title="Copy URL to current snippet">Share</button> <button id=__playground-run_8 class="playground-run hidden" title="Run code (Ctrl + Enter)">Run</button> <button id=__playground-cancel_8 class="playground-cancel hidden" title="Cancel edit (Escape)">Cancel</button> </div> <p>Gamut mapping can also be used to fit colors in other gamuts, for instance, fitting a Display P3 color into an sRGB gamut.</p> <div class=playground id=__playground_9> <div class=playground-results id=__playground-results_9> <div class=color-command><div class=swatch-bar><span class=swatch title="color(display-p3 0.99859 0.9923 0.32854)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(255 252.97 0) 50%, rgb(255 252.97 0) 50%"></span></span></div><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>c1</span> <span class=o>=</span> <span class=n>Color</span><span class=p>(</span><span class=s1>&#39;color(display-p3 1 1 0)&#39;</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>c1</span><span class=o>.</span><span class=n>in_gamut</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>)</span>
<span class=go>False</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>c1</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>)</span>
<span class=go>color(display-p3 0.99859 0.9923 0.32854 / 1)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>c1</span><span class=o>.</span><span class=n>in_gamut</span><span class=p>()</span>
<span class=go>True</span>
</code></pre></div></div> </div> <div class="playground-code hidden" id=__playground-code_9> <form autocomplete=off> <textarea class=playground-inputs id=__playground-inputs_9 spellcheck=false>c1 = Color('color(display-p3 1 1 0)')
c1.in_gamut('srgb')
c1.fit('srgb')
c1.in_gamut()</textarea> </form> </div> <button id=__playground-edit_9 class=playground-edit title="Edit the current snippet">Edit</button> <button id=__playground-share_9 class=playground-share title="Copy URL to current snippet">Share</button> <button id=__playground-run_9 class="playground-run hidden" title="Run code (Ctrl + Enter)">Run</button> <button id=__playground-cancel_9 class="playground-cancel hidden" title="Cancel edit (Escape)">Cancel</button> </div> <div class="admonition warning"> <p class=admonition-title>Caveats when Mapping in Other Spaces</p> <p>When fitting in another color space, results may vary depending on what color space you are in and what color space you are using to fit the color. We went into great depths when discussing <a href=#gamut-checking>gamut checking</a> about how transform functions from one color space to another are not always exact. We also gave quite a number of examples showing cases in which some color spaces were more sensitive to slight deviations outside their gamut than others. This is mainly mentioned as fitting in one color space and round tripping back may not give exact results:</p> <div class=playground id=__playground_10> <div class=playground-results id=__playground-results_10> <div class=color-command><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s2>&quot;color(--lch-d65 100 50 75)&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>fit</span><span class=p>()[:]</span>
<span class=go>[1.0, 1.0, 1.0, 1.0]</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s2>&quot;color(--lch-d65 100 50 75)&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>)[:]</span>
<span class=go>[1.0000000000000002, 0.9999999999999999, 0.9999999999999997, 1.0]</span>
</code></pre></div></div> </div> <div class="playground-code hidden" id=__playground-code_10> <form autocomplete=off> <textarea class=playground-inputs id=__playground-inputs_10 spellcheck=false>Color("color(--lch-d65 100 50 75)").convert('srgb').fit()[:]
Color("color(--lch-d65 100 50 75)").fit('srgb').convert('srgb')[:]</textarea> </form> </div> <button id=__playground-edit_10 class=playground-edit title="Edit the current snippet">Edit</button> <button id=__playground-share_10 class=playground-share title="Copy URL to current snippet">Share</button> <button id=__playground-run_10 class="playground-run hidden" title="Run code (Ctrl + Enter)">Run</button> <button id=__playground-cancel_10 class="playground-cancel hidden" title="Cancel edit (Escape)">Cancel</button> </div> <p>While the above case is well within the threshold, depending on what you are doing, and what spaces you are working in, it may make sense to fully convert to a space and work directly in that space opposed to the indirect fitting of a color in a different color space.</p> </div> <p>Clipping is not the default gamut mapping method, and generally not recommended to be used as such, but that doesn't mean it isn't useful. Clipping is still very important and can be used to trim channel noise after certain mathematical operations or even used in other gamut mapping algorithms if used carefully. For this reason, clip also has its own dedicated method for quick access: <code class=highlight><span class=n>clip</span><span class=p>()</span></code>. It can also be applied directly to the current color space or can be applied on the gamuts of other color spaces just like <code class=highlight><span class=n>fit</span><span class=p>()</span></code>.</p> <div class=playground id=__playground_11> <div class=playground-results id=__playground-results_11> <div class=color-command><div class=swatch-bar><span class=swatch title="rgb(255 30 120)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(255 30 120) 50%, rgb(255 30 120) 50%"></span></span> <span class=swatch title="color(display-p3 1 1 0.3309)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(255 255 0) 50%, rgb(255 255 0) 50%"></span></span></div><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s1>&#39;rgb(270 30 120)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>clip</span><span class=p>()</span>
<span class=go>color(srgb 1 0.11765 0.47059 / 1)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s1>&#39;color(display-p3 1 1 0)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=s1>&#39;srgb&#39;</span><span class=p>)</span>
<span class=go>color(display-p3 1 1 0.3309 / 1)</span>
</code></pre></div></div> </div> <div class="playground-code hidden" id=__playground-code_11> <form autocomplete=off> <textarea class=playground-inputs id=__playground-inputs_11 spellcheck=false>Color('rgb(270 30 120)').clip()
Color('color(display-p3 1 1 0)').clip('srgb')</textarea> </form> </div> <button id=__playground-edit_11 class=playground-edit title="Edit the current snippet">Edit</button> <button id=__playground-share_11 class=playground-share title="Copy URL to current snippet">Share</button> <button id=__playground-run_11 class="playground-run hidden" title="Run code (Ctrl + Enter)">Run</button> <button id=__playground-cancel_11 class="playground-cancel hidden" title="Cancel edit (Escape)">Cancel</button> </div> <p>There are actually many different ways to gamut map a color. Some are computationally expensive, some are quite simple, and many do really good in some cases and not so well in others. There is probably no perfect gamut mapping method, but some are better than others. ColorAide currently only offers a couple simple methods to gamut map.</p> <table> <thead> <tr> <th>Method</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>clip</code></td> <td>Simple, naive clipping.</td> </tr> <tr> <td><code>lch-chroma</code></td> <td>Uses a combination of chroma reduction and <abbr title="minimum delta E">MINDE</abbr> in the CIELCh color space to bring a color into gamut. This is the default method used.</td> </tr> <tr> <td><code>oklch-chroma</code></td> <td>Like <code>lch-chroma</code>, but uses the OkLCh color space instead. This is currently what the <a href=https://drafts.csswg.org/css-color/#binsearch>CSS Color Level 4 specification</a> recommends.</td> </tr> </tbody> </table> <div class="admonition note"> <p class=admonition-title>CSS Level 4 Gamut Mapping</p> <p>The CSS <a href=https://drafts.csswg.org/css-color/#binsearch>CSS Color Level 4 specification</a> currently recommends using OkLCh as the gamut mapping color space. <code>oklch-chroma</code> is our implementation of the CSS Level 4 color specification.</p> <p>OkLCh is a very new color space to be used in the field of gamut mapping. While CIELCh is not perfect, its weakness are known. OkLCh does seem to have certain quirks of its own, and may have may have more. While we have not made <code>oklch-chroma</code> our default yet, we have exposed the algorithm so users can begin exploring it.</p> </div> <h3 id=why-not-just-clip>Why Not Just Clip?<a class=headerlink href=#why-not-just-clip title="Permanent link"></a></h3> <p>In current web browsers, clipping is the default way in which out of gamut colors have been handled. It is fast, and has generally been fine as most browsers have been constrained to using sRGB. But as modern browsers begin to adopt more wide gamut monitors such as Display P3, and CSS grows to support an assortment of wide and ultra wide color spaces, representing the best intent of an out of gamut color becomes more important.</p> <p>ColorAide uses a default gamut mapping algorithm that performs gamut mapping in the CIELCh color space using chroma reduction coupled with minimum E (<abbr title="minimum delta E">MINDE</abbr>). This approach is meant to preserve enough of the important attributes of the out of gamut color as is possible, mostly preserving both lightness and hue, hue being the attribute that people are most sensitive to. <abbr title="minimum delta E">MINDE</abbr> is used to abandon chroma reduction and clip the color when the color is very close to being in gamut. <abbr title="minimum delta E">MINDE</abbr> also allows us to catch cases where the geometry of the color space's gamut is such that we may slip by higher chroma options resulting in undesirable, aggressive chroma reduction.</p> <p>Below we have an example of using chroma reduction with <abbr title="minimum delta E">MINDE</abbr>. It can be noted that chroma is reduced until we are very close to being in gamut. The <abbr title="minimum delta E">MINDE</abbr> helps us catch the peak of the yellow shape as, otherwise, we would have continued reducing chroma until we were at a very chroma reduced, pale yellow.</p> <p><img alt="Gamut LCh Chroma - yellow" src=../images/gamut-lch-chroma-yellow.png></p> <p>One might see some cases of clipping and think it does a fine job and question why any of this complexity is necessary. In order to demonstrate the differences in gamut mapping vs clipping, see the example below. We start with the color <span><span class="swatch out-of-gamut" title="color(display-p3 1 1 0)"><span class=swatch-color style="--swatch-stops: #fffd00,#fffd00;"></span></span><code class=highlight><span class=nf>color</span><span class=g>(</span><span class=kc>display-p3</span><span class=w> </span><span class=m>1</span><span class=w> </span><span class=m>1</span><span class=w> </span><span class=m>0</span><span class=g>)</span><span class=w></span></code></span> and interpolate with it in the CIELCh color space reducing just the lightness. This will leave both chroma and hue intact. The Interactive playground below automatically gamut maps the color previews to sRGB, but we'll control the method being used by providing two different <code class=highlight><span class=n>Color</span></code> objects: one that uses <code>lch-chroma</code> (the default) for gamut mapping, and one that uses <code>clip</code>. Notice how clipping, the bottom color set, clips these dark colors and makes them reddish. This is a very undesirable outcome.</p> <div class=playground id=__playground_12> <div class=playground-results id=__playground-results_12> <div class=color-command><div class=swatch-bar><span class="swatch out-of-gamut" title="color(display-p3 1 1 0)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(255 252.97 0) 50%, rgb(255 252.97 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.86965 0.87865 -0.1393)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(227.8 221.35 0) 50%, rgb(227.8 221.35 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.74183 0.76037 -0.16139)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(197.04 190.53 0) 50%, rgb(197.04 190.53 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.61856 0.64535 -0.17688)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(166.42 160.83 0) 50%, rgb(166.42 160.83 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.50161 0.53384 -0.19747)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(136.72 132.1 0) 50%, rgb(136.72 132.1 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.39311 0.42617 -0.22085)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(108.01 104.43 0) 50%, rgb(108.01 104.43 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.29717 0.32269 -0.24546)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(80.304 77.983 0) 50%, rgb(80.304 77.983 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.22186 0.22377 -0.27027)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(54.255 52.756 0) 50%, rgb(54.255 52.756 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.17897 0.12968 -0.29464)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(30.861 28.22 0) 50%, rgb(30.861 28.22 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.13001 0.03358 -0.31816)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(0 0 0) 50%, rgb(0 0 0) 50%"></span></span></div><div class=swatch-bar><span class="swatch out-of-gamut" title="color(display-p3 1 1 0)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(255 255 0) 50%, rgb(255 255 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.86965 0.87865 -0.1393)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(221.24 224.15 0) 50%, rgb(221.24 224.15 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.74183 0.76037 -0.16139)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(188.08 194.09 0) 50%, rgb(188.08 194.09 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.61856 0.64535 -0.17688)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(156.14 164.84 0) 50%, rgb(156.14 164.84 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.50161 0.53384 -0.19747)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(125.97 136.46 0) 50%, rgb(125.97 136.46 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.39311 0.42617 -0.22085)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(98.224 109.01 0) 50%, rgb(98.224 109.01 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.29717 0.32269 -0.24546)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(74.22 82.547 0) 50%, rgb(74.22 82.547 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.22186 0.22377 -0.27027)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(56.465 57.082 0) 50%, rgb(56.465 57.082 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.17897 0.12968 -0.29464)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(47.995 32.43 0) 50%, rgb(47.995 32.43 0) 50%"></span></span> <span class="swatch out-of-gamut" title="color(display-p3 0.13001 0.03358 -0.31816)Copy to clipboard"><span class=swatch-color style="--swatch-stops: rgb(36.643 6.7995 0) 50%, rgb(36.643 6.7995 0) 50%"></span></span></div><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=k>class</span> <span class=nc>ColorClip</span><span class=p>(</span><span class=n>Color</span><span class=p>):</span>
<span class=gp>... </span>    <span class=n>FIT</span> <span class=o>=</span> <span class=s1>&#39;clip&#39;</span>
<span class=gp>... </span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>yellow</span> <span class=o>=</span> <span class=n>Color</span><span class=p>(</span><span class=s1>&#39;color(display-p3 1 1 0)&#39;</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lightness_mask</span> <span class=o>=</span> <span class=n>Color</span><span class=p>(</span><span class=s1>&#39;lch(0% none none)&#39;</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>HtmlRow</span><span class=p>(</span><span class=n>Color</span><span class=o>.</span><span class=n>steps</span><span class=p>([</span><span class=n>yellow</span><span class=p>,</span> <span class=n>lightness_mask</span><span class=p>],</span> <span class=n>steps</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>space</span><span class=o>=</span><span class=s1>&#39;lch&#39;</span><span class=p>))</span>
<span class=go>[color(display-p3 1 1 0 / 1), color(display-p3 0.86965 0.87865 -0.1393 / 1), color(display-p3 0.74183 0.76037 -0.16139 / 1), color(display-p3 0.61856 0.64535 -0.17688 / 1), color(display-p3 0.50161 0.53384 -0.19747 / 1), color(display-p3 0.39311 0.42617 -0.22085 / 1), color(display-p3 0.29717 0.32269 -0.24546 / 1), color(display-p3 0.22186 0.22377 -0.27027 / 1), color(display-p3 0.17897 0.12968 -0.29464 / 1), color(display-p3 0.13001 0.03358 -0.31816 / 1)]</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>yellow</span> <span class=o>=</span> <span class=n>ColorClip</span><span class=p>(</span><span class=s1>&#39;color(display-p3 1 1 0)&#39;</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>lightness_mask</span> <span class=o>=</span> <span class=n>Color</span><span class=p>(</span><span class=s1>&#39;lch(0% none none)&#39;</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>HtmlRow</span><span class=p>(</span><span class=n>ColorClip</span><span class=o>.</span><span class=n>steps</span><span class=p>([</span><span class=n>yellow</span><span class=p>,</span> <span class=n>lightness_mask</span><span class=p>],</span> <span class=n>steps</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>space</span><span class=o>=</span><span class=s1>&#39;lch&#39;</span><span class=p>))</span>
<span class=go>[color(display-p3 1 1 0 / 1), color(display-p3 0.86965 0.87865 -0.1393 / 1), color(display-p3 0.74183 0.76037 -0.16139 / 1), color(display-p3 0.61856 0.64535 -0.17688 / 1), color(display-p3 0.50161 0.53384 -0.19747 / 1), color(display-p3 0.39311 0.42617 -0.22085 / 1), color(display-p3 0.29717 0.32269 -0.24546 / 1), color(display-p3 0.22186 0.22377 -0.27027 / 1), color(display-p3 0.17897 0.12968 -0.29464 / 1), color(display-p3 0.13001 0.03358 -0.31816 / 1)]</span>
</code></pre></div></div> </div> <div class="playground-code hidden" id=__playground-code_12> <form autocomplete=off> <textarea class=playground-inputs id=__playground-inputs_12 spellcheck=false>class ColorClip(Color):
    FIT = 'clip'

# Gamut mapping in LCh
yellow = Color('color(display-p3 1 1 0)')
lightness_mask = Color('lch(0% none none)')
HtmlRow(Color.steps([yellow, lightness_mask], steps=10, space='lch'))

# Clipping
yellow = ColorClip('color(display-p3 1 1 0)')
lightness_mask = Color('lch(0% none none)')
HtmlRow(ColorClip.steps([yellow, lightness_mask], steps=10, space='lch'))</textarea> </form> </div> <button id=__playground-edit_12 class=playground-edit title="Edit the current snippet">Edit</button> <button id=__playground-share_12 class=playground-share title="Copy URL to current snippet">Share</button> <button id=__playground-run_12 class="playground-run hidden" title="Run code (Ctrl + Enter)">Run</button> <button id=__playground-cancel_12 class="playground-cancel hidden" title="Cancel edit (Escape)">Cancel</button> </div> <p>There are times when clipping is simply preferred. It is fast, and if you are just trimming noise off channels, it is very useful, but if the idea is to present an in gamut color that tries to preserve as much of the intent of the original color as possible, other methods may be desired. There are no doubt better gamut methods available than ColorAide offers, and more may be added in the future, but ColorAide can also be extended using 3<sup>rd</sup> party plugins as well.</p> <style>
.info-container {display: inline-block;}
</style> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">July 22, 2022</span> </small> </div> <footer class=sponsorship> <hr> <a href=https://github.com/sponsors/facelessuser title="Become a sponsor"> <span class="twemoji heart-throb-hover"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path fill-rule=evenodd d="M7.655 14.916 8 14.25l.345.666a.752.752 0 0 1-.69 0zm0 0L8 14.25l.345.666.002-.001.006-.003.018-.01a7.643 7.643 0 0 0 .31-.17 22.08 22.08 0 0 0 3.433-2.414C13.956 10.731 16 8.35 16 5.5 16 2.836 13.914 1 11.75 1 10.203 1 8.847 1.802 8 3.02 7.153 1.802 5.797 1 4.25 1 2.086 1 0 2.836 0 5.5c0 2.85 2.045 5.231 3.885 6.818a22.075 22.075 0 0 0 3.744 2.584l.018.01.006.003h.002z"/></svg> </span> </a> <hr> </footer> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../distance/ class="md-footer__link md-footer__link--prev" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Color Distance and Delta E </div> </div> </a> <a href=../cat/ class="md-footer__link md-footer__link--next" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Chromatic Adaptation </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2020 - 2022 <a href=https://github.com/facelessuser target=_blank rel=noopener>Isaac Muse</a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> with emoji by <a href=https://github.com/twitter/twemoji target=_blank rel=noopener> Twemoji </a> </div> <div class=md-social> <a href=https://github.com/facelessuser target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://discord.gg/TWs8Tgr target=_blank rel=noopener title=discord.gg class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541ZM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241Zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241Z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.tabs", "navigation.top", "navigation.instant", "navigation.sections", "navigation.indexes", "toc.follow"], "search": "../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../assets/javascripts/bundle.48f2be22.min.js></script> <script src=https://unpkg.com/mermaid@8.13.3/dist/mermaid.min.js></script> <script src=../playground-config-1000d418.js></script> <script src=https://cdn.jsdelivr.net/pyodide/v0.20.0/full/pyodide.js></script> <script src=../assets/coloraide-extras/extra-notebook-ba3f3484.js></script> <script src=../assets/pymdownx-extras/extra-loader-6cff4ffc.js></script> </body> </html>