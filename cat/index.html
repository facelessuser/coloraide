<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A library to aid in using colors"><link href=https://facelessuser.github.io/coloraide/cat/ rel=canonical><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.1.2, mkdocs-material-7.1.4"><title>Chromatic Adaptation - ColorAide Documentation</title><link rel=stylesheet href=../assets/stylesheets/main.bde7dde4.min.css><link rel=stylesheet href=../assets/stylesheets/palette.ef6f36e2.min.css><meta name=theme-color content=#7e56c2><script src=../assets/pymdownx-extras/material-extra-theme-7c147bb7.js type=text/javascript></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><link rel=stylesheet href=../playground.css><link rel=stylesheet href=../assets/pymdownx-extras/extra-aa7dff8003.css></head> <body dir=ltr data-md-color-scheme=dracula data-md-color-primary=deep-purple data-md-color-accent=deep-purple> <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#chromatic-adaptation class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=https://facelessuser.github.io/coloraide title="ColorAide Documentation" class="md-header__button md-logo" aria-label="ColorAide Documentation"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5V2M6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> ColorAide Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Chromatic Adaptation </span> </div> </div> </div> <div class=md-header__options> <div class="md-header-nav__scheme md-header-nav__button md-source__icon md-icon"> <a href=javascript:toggleScheme(); title="Light mode" class=light-mode> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg> </a> <a href=javascript:toggleScheme(); title="Dark mode" class=dark-mode> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg> </a> <a href=javascript:toggleScheme(); title="System preference" class=system-mode> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7.5 2c-1.79 1.15-3 3.18-3 5.5s1.21 4.35 3.03 5.5C4.46 13 2 10.54 2 7.5A5.5 5.5 0 0 1 7.5 2m11.57 1.5 1.43 1.43L4.93 20.5 3.5 19.07 19.07 3.5m-6.18 2.43L11.41 5 9.97 6l.42-1.7L9 3.24l1.75-.12.58-1.65L12 3.1l1.73.03-1.35 1.13.51 1.67m-3.3 3.61-1.16-.73-1.12.78.34-1.32-1.09-.83 1.36-.09.45-1.29.51 1.27 1.36.03-1.05.87.4 1.31M19 13.5a5.5 5.5 0 0 1-5.5 5.5c-1.22 0-2.35-.4-3.26-1.07l7.69-7.69c.67.91 1.07 2.04 1.07 3.26m-4.4 6.58 2.77-1.15-.24 3.35-2.53-2.2m4.33-2.7 1.15-2.77 2.2 2.54-3.35.23m1.15-4.96-1.14-2.78 3.34.24-2.2 2.54M9.63 18.93l2.77 1.15-2.53 2.19-.24-3.34z"/></svg> </a> <a href=javascript:toggleScheme(); title="Unknown scheme" class=unknown-mode> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m15.07 11.25-.9.92C13.45 12.89 13 13.5 13 15h-2v-.5c0-1.11.45-2.11 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41a2 2 0 0 0-2-2 2 2 0 0 0-2 2H8a4 4 0 0 1 4-4 4 4 0 0 1 4 4 3.2 3.2 0 0 1-.93 2.25M13 19h-2v-2h2M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10c0-5.53-4.5-10-10-10z"/></svg> </a> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/facelessuser/coloraide/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class="md-tabs__link md-tabs__link--active"> ColorAide </a> </li> <li class=md-tabs__item> <a href=../colors/ class=md-tabs__link> Color Spaces </a> </li> <li class=md-tabs__item> <a href=../api/ class=md-tabs__link> API </a> </li> <li class=md-tabs__item> <a href=../playground/ class=md-tabs__link> Playground </a> </li> <li class=md-tabs__item> <a href=../about/contributing/ class=md-tabs__link> About </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="ColorAide Documentation" class="md-nav__button md-logo" aria-label="ColorAide Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5V2M6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5z"/></svg> </a> ColorAide Documentation </label> <div class=md-nav__source> <a href=https://github.com/facelessuser/coloraide/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1 checked> <label class=md-nav__link for=__nav_1> ColorAide <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=ColorAide data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> ColorAide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> Setup </a> </li> <li class=md-nav__item> <a href=../color/ class=md-nav__link> The Color Object </a> </li> <li class=md-nav__item> <a href=../manipulation/ class=md-nav__link> Manipulating Colors </a> </li> <li class=md-nav__item> <a href=../interpolation/ class=md-nav__link> Color Interpolation </a> </li> <li class=md-nav__item> <a href=../compositing/ class=md-nav__link> Compositing and Blending </a> </li> <li class=md-nav__item> <a href=../distance/ class=md-nav__link> Color Distance and Delta E </a> </li> <li class=md-nav__item> <a href=../gamut/ class=md-nav__link> Gamut Mapping </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Chromatic Adaptation <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Chromatic Adaptation </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=#changing-the-default-cat class=md-nav__link> Changing the Default CAT </a> </li> <li class=md-nav__item> <a href=#supported-cats class=md-nav__link> Supported CATs </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../contrast/ class=md-nav__link> Contrast </a> </li> <li class=md-nav__item> <a href=../strings/ class=md-nav__link> String Output </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Color Spaces <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Color Spaces" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Color Spaces </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../colors/ class=md-nav__link> Supported Colors </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> API <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=API data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../api/ class=md-nav__link> Color API </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../playground/ class=md-nav__link> Playground </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> About <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=About data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../about/contributing/ class=md-nav__link> Contributing &amp; Support </a> </li> <li class=md-nav__item> <a href=../about/changelog/ class=md-nav__link> Changelog </a> </li> <li class=md-nav__item> <a href=../about/license/ class=md-nav__link> License </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=#changing-the-default-cat class=md-nav__link> Changing the Default CAT </a> </li> <li class=md-nav__item> <a href=#supported-cats class=md-nav__link> Supported CATs </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/facelessuser/coloraide/tree/master/docs/src/markdown/cat.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1 id=chromatic-adaptation>Chromatic Adaptation<a class=headerlink href=#chromatic-adaptation title="Permanent link"></a></h1> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link"></a></h2> <p>Chromatic adaptation is the human visual system's ability to adjust to changes in illumination in order to preserve the appearance of object colors. It is responsible for the stable appearance of object colors despite the wide variation of light which might be reflected from an object and observed by our eyes. A chromatic adaptation transform (<abbr title="chromatic adaptation transform">CAT</abbr>) function emulates this important aspect of color perception in color appearance models.</p> <p>In short, colors look different under different lights. Viewing a color in daylight will look different than viewing it by candle light. Color spaces usually define a reference illuminant that clarifies the assumed lighting for the given space. For instance, sRGB is a color space defined with an illuminant of D65 (light in the shade - no direct sunlight - at noon). On the other hand, the ProPhoto RGB space a uses D50 illuminant (direct sunlight at noon). A given color under one illuminant would look different under the other.</p> <p>Often, when converting a color to a new illuminant, it is desired to have the new color look the same as the first under the new illuminant. A <abbr title="chromatic adaptation transform">CAT</abbr> can predict what that corresponding color under the new illuminant would have to be in order to look the same as the original color under the original illuminant.</p> <p>When translating a color from one illuminant to another, it is often desirable to represent that color under the new illuminant such that it appears to the eye the same as it did under the original illuminant. <abbr title="chromatic adaptation transform">CATs</abbr> are used to predict what the new color under the new illuminant should be in order to fulfill these requirements.</p> <p>For a quick example, we can demonstrate the basic principle when translating a color in the XYZ color space from a D50 illuminant to a D65 illuminant. Below, we can see that the colors look pretty much the same, even though they are now described under different illuminants.</p> <p> <div class=playground id=__playground_0> <div class=playground-results id=__playground-results_0> <div class=color-command><div class=swatch-bar><span class=swatch title="color(xyz 0.11627 0.07261 0.23256)"><span class=swatch-color style="--swatch-stops: rgb(102 51.004 153) 50%, rgb(102 51.004 153) 50%"></span></span> <span class=swatch title="color(xyz-d65 0.12412 0.07493 0.30923)"><span class=swatch-color style="--swatch-stops: rgb(102 51.004 153) 50%, rgb(102 51.004 153) 50%"></span></span></div><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>d50</span> <span class=o>=</span> <span class=n>Color</span><span class=p>(</span><span class=s1>&#39;color(xyz 0.11627 0.07261 0.23256 / 1)&#39;</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>d65</span> <span class=o>=</span> <span class=n>d50</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;xyz-d65&#39;</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>d50</span><span class=p>,</span> <span class=n>d65</span>
<span class=go>(color(xyz 0.11627 0.07261 0.23256 / 1), color(xyz-d65 0.12412 0.07493 0.30923 / 1))</span>
</code></pre></div></div> </div> <div class="playground-code hidden" id=__playground-code_0> <div class=highlight><pre><span></span><code><span class=n>d50</span> <span class=o>=</span> <span class=n>Color</span><span class=p>(</span><span class=s1>&#39;color(xyz 0.11627 0.07261 0.23256 / 1)&#39;</span><span class=p>)</span>
<span class=n>d65</span> <span class=o>=</span> <span class=n>d50</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;xyz-d65&#39;</span><span class=p>)</span>
<span class=n>d50</span><span class=p>,</span> <span class=n>d65</span>
</code></pre></div> <form autocomplete=off> <textarea class=playground-inputs id=__playground-inputs_0 spellcheck=false>d50 = Color('color(xyz 0.11627 0.07261 0.23256 / 1)')
d65 = d50.convert('xyz-d65')
d50, d65</textarea> </form> </div> <button id=__playground-edit_0 class=playground-edit title="Edit the current snippet">Edit</button> <button id=__playground-share_0 class=playground-share title="Copy URL to current snippet">Share</button> <button id=__playground-run_0 class="playground-run hidden" title="Run code (Ctrl + Enter)">Run</button> <button id=__playground-cancel_0 class="playground-cancel hidden" title="Cancel edit (Escape)">Cancel</button> </div> </p> <p>Under the hood, this is using the Bradford <abbr title="chromatic adaptation transform">CAT</abbr> (ColorAide's default <abbr title="chromatic adaptation transform">CAT</abbr>). Additionally, when translating from one color space to another, colors usually pass through an XYZ conversion as a common way point where a given <abbr title="chromatic adaptation transform">CAT</abbr> is applied.</p> <p>So we can actually do this manually and compare the results to what we did above. In order to this, we need to provide the specified "white point" for the source color and the "white point" for the destination color along with the XYZ coordinates we wish to transform:</p> <p> <div class=playground id=__playground_1> <div class=playground-results id=__playground-results_1> <div class=color-command><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span> <span class=nn>coloraide.color.convert</span> <span class=kn>import</span> <span class=n>cat</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Color</span><span class=p>(</span><span class=s1>&#39;color(xyz 0.11627 0.07261 0.23256 / 1)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;xyz-d65&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>coords</span><span class=p>()</span>
<span class=go>[0.1241213405260784, 0.07492817577403252, 0.309226464504967]</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>cat</span><span class=o>.</span><span class=n>chromatic_adaptation</span><span class=p>(</span><span class=s2>&quot;D50&quot;</span><span class=p>,</span> <span class=s2>&quot;D65&quot;</span><span class=p>,</span> <span class=p>[</span><span class=mf>0.11627</span><span class=p>,</span> <span class=mf>0.07261</span><span class=p>,</span> <span class=mf>0.23256</span><span class=p>],</span> <span class=n>method</span><span class=o>=</span><span class=s1>&#39;bradford&#39;</span><span class=p>)</span>
<span class=go>[0.1241213405260784, 0.07492817577403252, 0.309226464504967]</span>
</code></pre></div></div> </div> <div class="playground-code hidden" id=__playground-code_1> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>coloraide.color.convert</span> <span class=kn>import</span> <span class=n>cat</span>
<span class=n>Color</span><span class=p>(</span><span class=s1>&#39;color(xyz 0.11627 0.07261 0.23256 / 1)&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;xyz-d65&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>coords</span><span class=p>()</span>
<span class=n>cat</span><span class=o>.</span><span class=n>chromatic_adaptation</span><span class=p>(</span><span class=s2>&quot;D50&quot;</span><span class=p>,</span> <span class=s2>&quot;D65&quot;</span><span class=p>,</span> <span class=p>[</span><span class=mf>0.11627</span><span class=p>,</span> <span class=mf>0.07261</span><span class=p>,</span> <span class=mf>0.23256</span><span class=p>],</span> <span class=n>method</span><span class=o>=</span><span class=s1>&#39;bradford&#39;</span><span class=p>)</span>
</code></pre></div> <form autocomplete=off> <textarea class=playground-inputs id=__playground-inputs_1 spellcheck=false>from coloraide.color.convert import cat
Color('color(xyz 0.11627 0.07261 0.23256 / 1)').convert('xyz-d65').coords()
cat.chromatic_adaptation("D50", "D65", [0.11627, 0.07261, 0.23256], method='bradford')</textarea> </form> </div> <button id=__playground-edit_1 class=playground-edit title="Edit the current snippet">Edit</button> <button id=__playground-share_1 class=playground-share title="Copy URL to current snippet">Share</button> <button id=__playground-run_1 class="playground-run hidden" title="Run code (Ctrl + Enter)">Run</button> <button id=__playground-cancel_1 class="playground-cancel hidden" title="Cancel edit (Escape)">Cancel</button> </div> </p> <h2 id=changing-the-default-cat>Changing the Default <abbr title="chromatic adaptation transform">CAT</abbr><a class=headerlink href=#changing-the-default-cat title="Permanent link"></a></h2> <p>Changing the default <abbr title="chromatic adaptation transform">CAT</abbr> is easy and follows the same pattern as the rest of the <a href=../color/#override-default-settings>available class overrides</a>. Simply derive a new <code class=highlight><span class=n>Color</span><span class=p>()</span></code> class from the original and override the <code>CHROMATIC_ADAPTATION</code> property with the <a href=#supported-cats>name of the desired <abbr title="chromatic adaptation transform">CAT</abbr></a>. Afterwards, all color transforms will use the specified <abbr title="chromatic adaptation transform">CAT</abbr>.</p> <p> <div class=playground id=__playground_2> <div class=playground-results id=__playground-results_2> <div class=color-command><div class=swatch-bar><span class=swatch title="color(xyz 0.11627 0.07261 0.23256)"><span class=swatch-color style="--swatch-stops: rgb(102.7 52.23 152.14) 50%, rgb(102.7 52.23 152.14) 50%"></span></span> <span class=swatch title="color(xyz-d65 0.12475 0.07614 0.30571)"><span class=swatch-color style="--swatch-stops: rgb(102.7 52.23 152.14) 50%, rgb(102.7 52.23 152.14) 50%"></span></span></div><div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=k>class</span> <span class=nc>Custom</span><span class=p>(</span><span class=n>Color</span><span class=p>):</span>
<span class=gp>... </span>    <span class=n>CHROMATIC_ADAPTATION</span> <span class=o>=</span> <span class=s1>&#39;cat02&#39;</span>
<span class=gp>... </span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>d50</span> <span class=o>=</span> <span class=n>Custom</span><span class=p>(</span><span class=s1>&#39;color(xyz 0.11627 0.07261 0.23256 / 1)&#39;</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>d65</span> <span class=o>=</span> <span class=n>d50</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;xyz-d65&#39;</span><span class=p>)</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>d50</span><span class=p>,</span> <span class=n>d65</span>
<span class=go>(color(xyz 0.11627 0.07261 0.23256 / 1), color(xyz-d65 0.12475 0.07614 0.30571 / 1))</span>
</code></pre></div></div> </div> <div class="playground-code hidden" id=__playground-code_2> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>Custom</span><span class=p>(</span><span class=n>Color</span><span class=p>):</span>
    <span class=n>CHROMATIC_ADAPTATION</span> <span class=o>=</span> <span class=s1>&#39;cat02&#39;</span>

<span class=n>d50</span> <span class=o>=</span> <span class=n>Custom</span><span class=p>(</span><span class=s1>&#39;color(xyz 0.11627 0.07261 0.23256 / 1)&#39;</span><span class=p>)</span>
<span class=n>d65</span> <span class=o>=</span> <span class=n>d50</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=s1>&#39;xyz-d65&#39;</span><span class=p>)</span>
<span class=n>d50</span><span class=p>,</span> <span class=n>d65</span>
</code></pre></div> <form autocomplete=off> <textarea class=playground-inputs id=__playground-inputs_2 spellcheck=false>class Custom(Color):
    CHROMATIC_ADAPTATION = 'cat02'

d50 = Custom('color(xyz 0.11627 0.07261 0.23256 / 1)')
d65 = d50.convert('xyz-d65')
d50, d65</textarea> </form> </div> <button id=__playground-edit_2 class=playground-edit title="Edit the current snippet">Edit</button> <button id=__playground-share_2 class=playground-share title="Copy URL to current snippet">Share</button> <button id=__playground-run_2 class="playground-run hidden" title="Run code (Ctrl + Enter)">Run</button> <button id=__playground-cancel_2 class="playground-cancel hidden" title="Cancel edit (Escape)">Cancel</button> </div> </p> <h2 id=supported-cats>Supported <abbr title="chromatic adaptation transform">CATs</abbr><a class=headerlink href=#supported-cats title="Permanent link"></a></h2> <p>There are various <abbr title="chromatic adaptation transform">CATs</abbr>, all varying in complexity and accuracy. We will not go through all of them and instead will leave that up to the user to research as needed. Suffice it to say though that the Bradford <abbr title="chromatic adaptation transform">CAT</abbr> is currently the industry standard (in most cases), but there are a variety options available, and research continues to try and improve upon <abbr title="chromatic adaptation transform">CATs</abbr> of the past to come up with a better <abbr title="chromatic adaptation transform">CAT</abbr> for the future.</p> <p>Currently, ColorAide mainly supports von Kries type <abbr title="chromatic adaptation transform">CATs</abbr> (named after an early 20<sup>th</sup> century color scientist), or <abbr title="chromatic adaptation transform">CATs</abbr> that are similar to and/or are built upon the original von Kries <abbr title="chromatic adaptation transform">CAT</abbr>. We also do not currently support every known von Kries <abbr title="chromatic adaptation transform">CAT</abbr> out there, but a good number are available. In the future, support may be expanded.</p> <table> <thead> <tr> <th><abbr title="chromatic adaptation transform">CAT</abbr></th> </tr> </thead> <tbody> <tr> <td><code>bradford</code></td> </tr> <tr> <td><code>von-kries</code></td> </tr> <tr> <td><code>xyz-scaling</code></td> </tr> <tr> <td><code>sharp</code></td> </tr> <tr> <td><code>cat02</code></td> </tr> <tr> <td><code>cmccat97</code></td> </tr> <tr> <td><code>cmccat2000</code></td> </tr> </tbody> </table> <script src=https://cdn.jsdelivr.net/pyodide/v0.17.0/full/pyodide.js></script> <script type=text/javascript>
let busy = false;
let requests = 0;
let last_text = '';
const reIdNum = /.*?_(\d+)$/;
let initialized = false;


async function pyexecute(current_id) {
  // Execute Python code

  let pycode = `
"""
Special Python color code blocks.

Transform Python code by executing it, transforming to a Python console output,
and finding and outputting color previews.
"""
import micropip
from js import document, location
from collections.abc import Sequence
from collections import namedtuple
import ast
from io import StringIO
import contextlib
import sys
import re
from pygments import highlight
from pygments.lexers import get_lexer_by_name
from pygments.formatters import find_formatter_class
HtmlFormatter = find_formatter_class('html')

inputs = document.getElementById("__playground-inputs_{}".format(globals()['id_num']))
results = document.getElementById("__playground-results_{}".format(globals()['id_num']))
pgcode = document.getElementById("__playground-code_{}".format(globals()['id_num']))

AST_BLOCKS = (ast.If, ast.For, ast.While, ast.Try, ast.With, ast.FunctionDef, ast.ClassDef)

RE_COLOR_START = re.compile(
    r"(?i)(?:\\b(?<![-#&$])(?:color|hsla?|lch|lab|hwb|rgba?)\\(|\\b(?<![-#&$])[\\w]{3,}(?![(-])\\b|(?<![&])#)"
)


class ColorInterpolate(list):
    """Color interpolate."""


class ColorTuple(namedtuple('ColorTuple', ['string', 'color'])):
    """Color tuple."""


@contextlib.contextmanager
def std_output(stdout=None):
    """Capture standard out."""
    old = sys.stdout
    if stdout is None:
        stdout = StringIO()
    sys.stdout = stdout
    yield stdout
    sys.stdout = old


def get_colors(result):
    """Get color from results."""

    from coloraide import Color
    from coloraide.color.interpolate import Interpolator

    colors = []
    if isinstance(result, Color):
        colors.append(ColorTuple(result.to_string(), result))
    elif isinstance(result, Interpolator):
        colors = ColorInterpolate(result.steps(steps=5, max_delta_e=4))
    elif isinstance(result, str):
        try:
            colors.append(ColorTuple(result, Color(result)))
        except Exception:
            pass
    elif isinstance(result, Sequence):
        for x in result:
            if isinstance(x, Color):
                colors.append(ColorTuple(x.to_string(), x))
            elif isinstance(x, str):
                try:
                    colors.append(ColorTuple(x, Color(x)))
                except Exception:
                    pass
    return colors


def find_colors(text):
    """Find colors in text buffer."""

    from coloraide import Color

    colors = []
    for m in RE_COLOR_START.finditer(text):
        start = m.start()
        mcolor = Color.match(text, start=start)
        if mcolor is not None:
            colors.append(ColorTuple(text[mcolor.start:mcolor.end], mcolor.color))
    return colors


def execute(cmd):
    """Execute color commands."""

    import coloraide
    from coloraide import Color, NaN, Piecewise

    g = {'Color': Color, 'coloraide': coloraide, 'NaN': NaN, 'Piecewise': Piecewise}
    console = ''
    colors = []

    # Build AST tree
    src = cmd.strip()
    lines = src.split('\\n')
    tree = ast.parse(src)

    for node in tree.body:
        result = None

        # Format source as Python console statements
        start = node.lineno
        end = node.end_lineno
        stmt = lines[start - 1: end]
        command = ''
        for i, line in enumerate(stmt, 0):
            if i == 0:
                stmt[i] = '>>> ' + line
            else:
                stmt[i] = '... ' + line
        command += '\\n'.join(stmt)
        if isinstance(node, AST_BLOCKS):
            command += '\\n... '

        try:
            # Capture anything sent to standard out
            text = ''
            with std_output() as s:
                # Execute code
                if isinstance(node, ast.Expr):
                    _eval = ast.Expression(node.value)
                    result = eval(compile(_eval, '<string>', 'eval'), g)
                else:
                    _exec = ast.Module([node], [])
                    exec(compile(_exec, '<string>', 'exec'), g)

                # Execution went well, so append command
                console += command

                # Output captured standard out after statements
                text = s.getvalue()
                if text:
                    clist = find_colors(text)
                    if clist:
                        colors.extend(clist)
                    console += '\\n{}'.format(text)
                s.flush()
        except Exception:
            # Failed for some reason, so quit
            break

        # If we got a result, output it as well
        if result is not None:
            clist = get_colors(result)
            if clist:
                colors.append(clist)
            console += '{}{}'.format('\\n' if not text else '', str(result))
        console += '\\n'

    return console, colors


def colorize(src, lang, **options):
    """Colorize."""

    lexer = get_lexer_by_name(lang, **options)
    formatter = HtmlFormatter(cssclass="highlight", wrapcode=True)
    return highlight(src, lexer, formatter).strip()


def color_command_formatter(src):
    """Formatter wrapper."""

    from coloraide import Color

    try:
        fit = True
        console, colors = execute(src.strip())
        el = ''
        bar = False
        values = []
        for item in colors:
            if isinstance(item, ColorInterpolate):
                if bar:
                    el += '<div class="swatch-bar">{}</div>'.format(' '.join(values))
                    values = []
                sub_el1 = '<div class="swatch-bar"><span class="swatch swatch-gradient">{}</span></div>'
                style = "--swatch-stops: "
                stops = []
                for color in item:
                    color.fit("srgb", in_place=True)
                    stops.append(color.convert("srgb").to_string())
                if not stops:
                    stops.extend(['transparent'] * 2)
                if len(stops) == 1:
                    stops.append(stops[0])
                style += ','.join(stops)
                sub_el2 = '<span class="swatch-color" style="{}"></span>'.format(style)
                el += sub_el1.format(sub_el2)
                bar = False
            else:
                bar = True
                base_classes = "swatch"
                for color in item:
                    if not color.color.in_gamut('srgb') and not fit:
                        c = '<span class="swatch-color"></span>'
                        classes = base_classes + " out-of-gamut"
                        title = "Out of Gamut&#10;{}".format(color.string)
                    else:
                        color.color.fit('srgb', in_place=True)
                        srgb = color.color.convert('srgb')
                        value1 = srgb.to_string(alpha=False)
                        value2 = srgb.to_string()
                        style = "--swatch-stops: {} 50%, {} 50%".format(value1, value2)
                        title = color.string
                        classes = base_classes
                        c = '<span class="swatch-color" style="{style}"></span>'.format(style=style)
                    c = '<span class="{classes}" title="{title}">{color}</span>'.format(
                        classes=classes,
                        color=c,
                        title=title
                    )
                    values.append(c)
        if bar:
            el += '<div class="swatch-bar">{}</div>'.format(' '.join(values))
            values = []
        if not colors:
            el += '<div class="swatch-bar"></div>'

        el += colorize(console, 'pycon', **{'python3': True, 'stripnl': False})
        el = '<div class="color-command">{}</div>'.format(el)
    except Exception:
        return '<div class="color-command"><div class="swatch-bar"></div>{}</div>'.format(colorize('', 'text'))
    return el


def process_code(*args):
    """Process code."""

    try:
        # Run code
        results.innerHTML = color_command_formatter(inputs.value)
        scrollingElement = results.querySelector('code')
        scrollingElement.scrollTop = scrollingElement.scrollHeight
    except Exception as e:
        print(e)

wheel = 'coloraide-0.1.0a21-py3-none-any.whl'

w = (
    location.origin + '/' +
    ('coloraide/' if location.origin == 'https://facelessuser.github.io' else '') +
    'playground/' + wheel
)

micropip.install(w).add_done_callback(process_code)
`
  console.log(`__playground-inputs_${current_id}`)
  const current_inputs = document.getElementById(`__playground-inputs_${current_id}`);
  current_inputs.setAttribute('readonly', '');
  pyodide.globals.set('id_num', current_id);
  await pyodide.runPythonAsync(pycode);
  current_inputs.removeAttribute('readonly');
}

async function load_pyodide() {
  if (!initialized) {
    const buttons = document.querySelectorAll('.playground button');
    if (buttons) {
      buttons.forEach((b) => {
        b.setAttribute('disabled', '');
        if (b.classList.contains('playground-edit')) {
          b.innerHTML = 'Loading...';
        }
      });
    }
    initialized = true;
    await loadPyodide({indexURL : "https://cdn.jsdelivr.net/pyodide/v0.17.0/full/" });
    await pyodide.loadPackage(['micropip', 'Pygments']);
    if (buttons) {
      buttons.forEach((b) => {
        b.removeAttribute('disabled');
        if (b.classList.contains('playground-edit')) {
          b.innerHTML = 'Edit';
        }
      });
    }
  }
}

function highlight (inputs, current_id) {
  // Manage incoming highlight requests.

  // Throttle requests
  if (busy) {
    return;
  }

  // Execute
  if (requests) {
    requests = 0;
    busy = true;
    pyhighlight(inputs.value, current_id);
  }
};

async function pyhighlight(inputs, current_id) {
  // Highlight current input code

  let pycode = `
from js import document
from pygments import highlight
from pygments.lexers import get_lexer_by_name
from pygments.formatters import find_formatter_class

HtmlFormatter = find_formatter_class('html')

def colorize(src, lang, **options):
    """Colorize."""

    lexer = get_lexer_by_name(lang, **options)
    formatter = HtmlFormatter(cssclass="highlight", wrapcode=True)
    return highlight(src, lexer, formatter).strip()

inputs = document.getElementById("__playground-inputs_${current_id}")
pgcode = document.getElementById("__playground-code_${current_id}")

div = pgcode.querySelector(".highlight")
template = document.createElement('template')
html = colorize(inputs.value + '\\n', 'py3', **{'python3': True, 'stripnl': False})
template.innerHTML = html;
pgcode.replaceChild(template.content.firstChild, div)
code = pgcode.querySelector('code')
code.scrollLeft = inputs.scrollLeft
code.scrollTop = inputs.scrollTop
`
  await pyodide.runPythonAsync(pycode);
  busy = false;
  if (requests) {
    setTimeout(() => {highlight(inputs, current_id);}, 100);
  }
}

async function loadExternalSrc() {
  if (window.location.pathname.endsWith("/playground/")) {
    const pginputs = document.querySelector('.playground-inputs');
    const pg_id = pginputs.id.replace(reIdNum, '$1');
    let params = new URLSearchParams(window.location.search);
    if (params.has('source')) {
      // A source was specified, so load it.
      await load_pyodide();
      try {
        const uri = params.get('source');
        let xhr = new XMLHttpRequest();
        xhr.open("GET", uri, true);
        xhr.onload = function (e) {
          // Try and load the requested content
          if (xhr.readyState === 4) {
            if (xhr.status === 200) {
              pginputs.value = xhr.responseText;
            }
          }
          requests = 1;
          highlight(pginputs, pg_id);
          pyexecute(pg_id);
        };
        xhr.send();
      } catch (err) {}
    } else if (params.has('code')) {
      // Raw code provided.
      await load_pyodide();
      requests = 1;
      pginputs.value = params.get('code');
      highlight(pginputs, pg_id);
      pyexecute(pg_id);
    }
  }
}

async function main() {
  // Setup input highlighting and events to run Python code blocks.

  const playgrounds = document.querySelectorAll('.playground');
  playgrounds.forEach(async function(pg) {

    const current_id = pg.id.replace(reIdNum, '$1');
    const inputs = document.getElementById(`__playground-inputs_${current_id}`);
    const results = document.getElementById(`__playground-results_${current_id}`);
    const pgcode = document.getElementById(`__playground-code_${current_id}`);
    const button_edit = document.querySelector(`button#__playground-edit_${current_id}`);
    const button_share = document.querySelector(`button#__playground-share_${current_id}`);
    const button_run = document.querySelector(`button#__playground-run_${current_id}`);
    const button_cancel = document.querySelector(`button#__playground-cancel_${current_id}`);
    const default_text = "# Insert your code here!\ncoloraide.__version__\nColor('red')";

    inputs.addEventListener("input", (e) => {
      // Handle highlighting as input changes.

      requests++;
      highlight(inputs, current_id);
    });

    inputs.addEventListener("scroll", (e) => {
      // Sync overlay textarea scrolling with highlighted code block underneath.

      const code = pgcode.querySelector("code");
      code.scrollLeft = e.target.scrollLeft;
      code.scrollTop = e.target.scrollTop;
    });

    document.addEventListener("keydown", (e) => {
      // Ctrl + Enter in textarea will execute the code.

      if (event.defaultPrevented) {
        return; // Do nothing if the event was already processed
      }

      if (
        e.ctrlKey &&
        e.key === "Enter" &&
        button_edit.classList.contains('hidden') &&
        inputs === document.activeElement
      ) {
        button_run.click();
      } else if (
        e.key === "Escape" &&
        button_edit.classList.contains('hidden') &&
        inputs === document.activeElement
      ) {
        button_cancel.click();
      }
    });

    inputs.addEventListener('touchmove', (e) => {
      // Stop propogation on "touchmove".

      e.stopPropagation();
    });

    button_edit.addEventListener("click", async function(e) {
      // Handle the button click: show source or execute source.

      if (busy) {
        return;
      }

      // Load Piodide and related packages.
      await load_pyodide();

      busy = true;
      last_text = inputs.value;
      pgcode.classList.toggle('hidden');
      results.classList.toggle('hidden');
      button_run.classList.toggle('hidden');
      button_cancel.classList.toggle('hidden');
      button_edit.classList.toggle('hidden');
      button_share.classList.toggle('hidden');
      inputs.focus();
      busy = false;
    });

    button_share.addEventListener("click", (e) => {
      // Handle the share click: copy URL with code as parameter.

      if (busy) {
        return;
      }

      busy = true;
      const uri = encodeURIComponent(inputs.value).replace(/[.!'()*]/g, (c) => {
        return '%' + c.charCodeAt(0).toString(16);
      });
      const loc = window.location;
      let pathname = '/playground/';
      if (loc.pathname.startsWith('/coloraide/')) {
        pathname = '/coloraide/playground/'
      }
      const path = loc.protocol + '//' + loc.host + pathname + '?code=' + uri;
      if (uri.length > 1000) {
        alert('Code must be under a 1000 characters to generate a URL!');
      } else {
        navigator.clipboard.writeText(path).then(function() {
          alert('Link copied to clipboard :)');
        }, function() {
          alert('Failed to copy link clipboard!');
        });
      }
      busy = false;
    });

    button_run.addEventListener("click", async function(e) {
      // Handle the button click: show source or execute source.

      if (busy) {
        return;
      }

      busy = true;
      results.querySelector('code').innerHTML = '';
      pyexecute(current_id);
      pgcode.classList.toggle('hidden');
      results.classList.toggle('hidden');
      button_edit.classList.toggle('hidden');
      button_share.classList.toggle('hidden');
      button_run.classList.toggle('hidden');
      button_cancel.classList.toggle('hidden');
      busy = false;
    });

    button_cancel.addEventListener("click", (e) => {
      // Cancel edit.

      if (busy) {
        return;
      }

      busy = true;
      inputs.value = last_text;
      pgcode.classList.toggle('hidden');
      results.classList.toggle('hidden');
      button_edit.classList.toggle('hidden');
      button_share.classList.toggle('hidden');
      button_run.classList.toggle('hidden');
      button_cancel.classList.toggle('hidden');
      busy = false;
      requests++;
      highlight(inputs, current_id);
    });
  });

  await loadExternalSrc();
}

// Run main
main();
</script> <hr> <div class=md-source-date> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">May 9, 2021</span> </small> </div> <footer class=sponsorship> <hr> <a href=https://github.com/sponsors/facelessuser title="Become a sponsor"> <span class="twemoji heart-throb-hover"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path fill-rule=evenodd d="M7.655 14.916 8 14.25l.345.666a.752.752 0 0 1-.69 0zm0 0L8 14.25l.345.666.002-.001.006-.003.018-.01a7.643 7.643 0 0 0 .31-.17 22.08 22.08 0 0 0 3.433-2.414C13.956 10.731 16 8.35 16 5.5 16 2.836 13.914 1 11.75 1 10.203 1 8.847 1.802 8 3.02 7.153 1.802 5.797 1 4.25 1 2.086 1 0 2.836 0 5.5c0 2.85 2.045 5.231 3.885 6.818a22.075 22.075 0 0 0 3.744 2.584l.018.01.006.003h.002z"/></svg> </span> </a> <hr> </footer> </article> </div> </div> <a href=# class="md-top md-icon" title="Back to top" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../gamut/ class="md-footer__link md-footer__link--prev" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Gamut Mapping </div> </div> </a> <a href=../contrast/ class="md-footer__link md-footer__link--next" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Contrast </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2014 - 2021 <a href=https://github.com/facelessuser target=_blank rel=noopener>Isaac Muse</a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> with emoji by <a href=https://github.com/twitter/twemoji target=_blank rel=noopener> Twemoji </a> </div> <div class=md-footer-social> <a href=https://github.com/facelessuser target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://discord.gg/TWs8Tgr target=_blank rel=noopener title=discord.gg class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M297.216 243.2c0 15.616-11.52 28.416-26.112 28.416-14.336 0-26.112-12.8-26.112-28.416s11.52-28.416 26.112-28.416c14.592 0 26.112 12.8 26.112 28.416zm-119.552-28.416c-14.592 0-26.112 12.8-26.112 28.416s11.776 28.416 26.112 28.416c14.592 0 26.112-12.8 26.112-28.416.256-15.616-11.52-28.416-26.112-28.416zM448 52.736V512c-64.494-56.994-43.868-38.128-118.784-107.776l13.568 47.36H52.48C23.552 451.584 0 428.032 0 398.848V52.736C0 23.552 23.552 0 52.48 0h343.04C424.448 0 448 23.552 448 52.736zm-72.96 242.688c0-82.432-36.864-149.248-36.864-149.248-36.864-27.648-71.936-26.88-71.936-26.88l-3.584 4.096c43.52 13.312 63.744 32.512 63.744 32.512-60.811-33.329-132.244-33.335-191.232-7.424-9.472 4.352-15.104 7.424-15.104 7.424s21.248-20.224 67.328-33.536l-2.56-3.072s-35.072-.768-71.936 26.88c0 0-36.864 66.816-36.864 149.248 0 0 21.504 37.12 78.08 38.912 0 0 9.472-11.52 17.152-21.248-32.512-9.728-44.8-30.208-44.8-30.208 3.766 2.636 9.976 6.053 10.496 6.4 43.21 24.198 104.588 32.126 159.744 8.96 8.96-3.328 18.944-8.192 29.44-15.104 0 0-12.8 20.992-46.336 30.464 7.68 9.728 16.896 20.736 16.896 20.736 56.576-1.792 78.336-38.912 78.336-38.912z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.tabs", "navigation.top"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.4fa0e4ee.min.js", "version": null}</script> <script src=../assets/javascripts/bundle.1d3bfcf1.min.js></script> <script src=../assets/pymdownx-extras/extra-uml-51b11a9a.js></script> </body> </html>